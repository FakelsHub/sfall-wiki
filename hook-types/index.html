<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Типы кючков - sfall - Scripting</title> <link rel="shortcut icon" href="/sfall-wiki/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/sfall-wiki/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/sfall-wiki/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/sfall-wiki/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Типы кючков | sfall - Scripting</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Типы кючков" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="sfall functions documentation" /> <meta property="og:description" content="sfall functions documentation" /> <link rel="canonical" href="/sfall-wiki/hook-types/" /> <meta property="og:url" content="/sfall-wiki/hook-types/" /> <meta property="og:site_name" content="sfall - Scripting" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Типы кючков" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"sfall functions documentation","headline":"Типы кючков","url":"/sfall-wiki/hook-types/"}</script> <!-- End Jekyll SEO tag --> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png"> <link rel="manifest" href="/assets/favicon/site.webmanifest"> <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/assets/favicon/browserconfig.xml"> <meta name="theme-color" content="#ffffff"> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/sfall-wiki/" class="site-title lh-tight"> sfall - Scripting </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/" class="nav-list-link">Документация</a><ul class="nav-list "><li class="nav-list-item "><a href="/sfall-wiki/data-types/" class="nav-list-link">Типы данных</a></li><li class="nav-list-item "><a href="/sfall-wiki/sslc/" class="nav-list-link">Компилятор (sslc)</a></li><li class="nav-list-item "><a href="/sfall-wiki/optimization/" class="nav-list-link">Оптимизация</a></li><li class="nav-list-item "><a href="/sfall-wiki/best-practices/" class="nav-list-link">Практические советы</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/global-scripts/" class="nav-list-link">Глобальные сценарии</a><ul class="nav-list "><li class="nav-list-item "><a href="/sfall-wiki/global-functions/" class="nav-list-link">Функции глобальных скриптов</a></li><li class="nav-list-item "><a href="/sfall-wiki/global-variables/" class="nav-list-link">Функции глобальных переменных</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/arrays/" class="nav-list-link">Массивы (Arrays)</a><ul class="nav-list "><li class="nav-list-item "><a href="/sfall-wiki/array-functions/" class="nav-list-link">Функции массивов</a></li><li class="nav-list-item "><a href="/sfall-wiki/lists/" class="nav-list-link">Списки (Lists)</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/hooks/" class="nav-list-link">Крючки (Hooks)</a><ul class="nav-list "><li class="nav-list-item "><a href="/sfall-wiki/hook-functions/" class="nav-list-link">Функции крючков</a></li><li class="nav-list-item active"><a href="/sfall-wiki/hook-types/" class="nav-list-link active">Типы кючков</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/script-functions/" class="nav-list-link">Функции скриптов</a><ul class="nav-list "><li class="nav-list-item "><a href="/sfall-wiki/car/" class="nav-list-link">Car</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/combat/" class="nav-list-link">Combat</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/critical-table/" class="nav-list-link">Critical table</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/knockback/" class="nav-list-link">Knockback</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/weapons-and-ammo/" class="nav-list-link">Weapons and Ammo</a> </li></ul></li><li class="nav-list-item "><a href="/sfall-wiki/critters/" class="nav-list-link">Critters</a></li><li class="nav-list-item "><a href="/sfall-wiki/explosions/" class="nav-list-link">Explosions</a></li><li class="nav-list-item "><a href="/sfall-wiki/general/" class="nav-list-link">General</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/graphics/" class="nav-list-link">Graphics (Графика)</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/animations/" class="nav-list-link">Animations</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/art/" class="nav-list-link">Art</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/object-outline/" class="nav-list-link">Object outline</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/shaders/" class="nav-list-link">Shaders</a> </li></ul></li><li class="nav-list-item "><a href="/sfall-wiki/ini-settings/" class="nav-list-link">INI settings</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/interface/" class="nav-list-link">Interface</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/cursor/" class="nav-list-link">Cursor</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/drawing/" class="nav-list-link">Drawing</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/main-interface/" class="nav-list-link">Main interface</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/message-window/" class="nav-list-link">Message window</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/tags/" class="nav-list-link">Tags</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/windows/" class="nav-list-link">Windows</a> </li></ul></li><li class="nav-list-item "><a href="/sfall-wiki/inventory/" class="nav-list-link">Inventory</a></li><li class="nav-list-item "><a href="/sfall-wiki/keyboard-and-mouse/" class="nav-list-link">Keyboard and Mouse</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/maps-and-encounters/" class="nav-list-link">Maps and Encounters</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/localmap/" class="nav-list-link">Localmap</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/worldmap/" class="nav-list-link">Worldmap</a> </li></ul></li><li class="nav-list-item "><a href="/sfall-wiki/maths/" class="nav-list-link">Maths (Математические)</a></li><li class="nav-list-item "><a href="/sfall-wiki/misc/" class="nav-list-link">Misc (Разное)</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/objects/" class="nav-list-link">Objects</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/locks/" class="nav-list-link">Locks</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/scripts/" class="nav-list-link">Scripts</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/perks-and-traits/" class="nav-list-link">Perks and Traits</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/common-fake-perk-trait/" class="nav-list-link">Common fake perk/trait</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/npc-fake-perk-trait/" class="nav-list-link">NPC fake perk/trait</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/setting-perks/" class="nav-list-link">Setting perks</a> </li></ul></li><li class="nav-list-item "><a href="/sfall-wiki/prototypes/" class="nav-list-link">Prototypes</a></li><li class="nav-list-item "><a href="/sfall-wiki/skills/" class="nav-list-link">Skills</a></li><li class="nav-list-item "><a href="/sfall-wiki/sound-and-movie/" class="nav-list-link">Sound and Movie</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/stats/" class="nav-list-link">Stats</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/stats-min-max/" class="nav-list-link">Stats min/max</a> </li></ul></li><li class="nav-list-item "><a href="/sfall-wiki/strings/" class="nav-list-link">Strings (Текстовые)</a></li><li class="nav-list-item "><a href="/sfall-wiki/tiles-and-paths/" class="nav-list-link">Tiles and Paths</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/system-functions/" class="nav-list-link">Системные функции</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/sfall-wiki/direct-memory-access/" class="nav-list-link">Direct memory access</a><ul class="nav-list"><li class="nav-list-item "> <a href="/sfall-wiki/calls/" class="nav-list-link">Calls</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/read/" class="nav-list-link">Read</a> </li><li class="nav-list-item "> <a href="/sfall-wiki/write/" class="nav-list-link">Write</a> </li></ul></li><li class="nav-list-item "><a href="/sfall-wiki/funcx-metarule/" class="nav-list-link">FuncX metarule</a></li><li class="nav-list-item "><a href="/sfall-wiki/others/" class="nav-list-link">Others</a></li><li class="nav-list-item "><a href="/sfall-wiki/sfall-version/" class="nav-list-link">Sfall version</a></li><li class="nav-list-item "><a href="/sfall-wiki/virtual-file-system/" class="nav-list-link">Virtual file system</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search sfall - Scripting" aria-label="Search sfall - Scripting" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://nma-fallout.com/threads/fo2-engine-tweaks-sfall.178390/" class="site-button" > Forum </a> </li> <li class="aux-nav-list-item"> <a href="https://github.com/FakelsHub/sFall-Extended" class="site-button" > GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/sfall-wiki/hooks/">Крючки (Hooks)</a></li> <li class="breadcrumb-nav-list-item"><span>Типы кючков</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="hook-types"> <a href="#hook-types" class="anchor-heading" aria-labelledby="hook-types"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hook types </h1> <ul id="markdown-toc"> <li><a href="#adjustfid" id="markdown-toc-adjustfid">AdjustFID</a></li> <li><a href="#adjustpoison" id="markdown-toc-adjustpoison">AdjustPoison</a></li> <li><a href="#adjustrads" id="markdown-toc-adjustrads">AdjustRads</a></li> <li><a href="#afterhitroll" id="markdown-toc-afterhitroll">AfterHitRoll</a></li> <li><a href="#ammocost" id="markdown-toc-ammocost">AmmoCost</a></li> <li><a href="#barterprice" id="markdown-toc-barterprice">BarterPrice</a></li> <li><a href="#bestweapon" id="markdown-toc-bestweapon">BestWeapon</a></li> <li><a href="#calcapcost" id="markdown-toc-calcapcost">CalcAPCost</a></li> <li><a href="#canuseweapon" id="markdown-toc-canuseweapon">CanUseWeapon</a></li> <li><a href="#cartravel" id="markdown-toc-cartravel">CarTravel</a></li> <li><a href="#combatdamage" id="markdown-toc-combatdamage">CombatDamage</a></li> <li><a href="#combatturn" id="markdown-toc-combatturn">CombatTurn</a></li> <li><a href="#deathanim1" id="markdown-toc-deathanim1">DeathAnim1</a></li> <li><a href="#deathanim2" id="markdown-toc-deathanim2">DeathAnim2</a></li> <li><a href="#descriptionobj" id="markdown-toc-descriptionobj">DescriptionObj</a></li> <li><a href="#encounter" id="markdown-toc-encounter">Encounter</a></li> <li><a href="#explosivetimer" id="markdown-toc-explosivetimer">ExplosiveTimer</a></li> <li><a href="#findtarget" id="markdown-toc-findtarget">FindTarget</a></li> <li><a href="#gamemodechange" id="markdown-toc-gamemodechange">GameModeChange</a></li> <li><a href="#invenwield" id="markdown-toc-invenwield">InvenWield</a></li> <li><a href="#inventorymove" id="markdown-toc-inventorymove">InventoryMove</a></li> <li><a href="#itemdamage" id="markdown-toc-itemdamage">ItemDamage</a></li> <li><a href="#keypress" id="markdown-toc-keypress">KeyPress</a></li> <li><a href="#mouseclick" id="markdown-toc-mouseclick">MouseClick</a></li> <li><a href="#movecost" id="markdown-toc-movecost">MoveCost</a></li> <li><a href="#ondeath" id="markdown-toc-ondeath">OnDeath</a></li> <li><a href="#onexplosion" id="markdown-toc-onexplosion">OnExplosion</a></li> <li><a href="#removeinvenobj" id="markdown-toc-removeinvenobj">RemoveInvenObj</a></li> <li><a href="#resttimer" id="markdown-toc-resttimer">RestTimer</a></li> <li><a href="#rollcheck" id="markdown-toc-rollcheck">RollCheck</a></li> <li><a href="#setglobalvar" id="markdown-toc-setglobalvar">SetGlobalVar</a></li> <li><a href="#setlighting" id="markdown-toc-setlighting">SetLighting</a></li> <li><a href="#sneak" id="markdown-toc-sneak">Sneak</a></li> <li><a href="#stdprocedure" id="markdown-toc-stdprocedure">StdProcedure</a></li> <li><a href="#stdprocedureend" id="markdown-toc-stdprocedureend">StdProcedureEnd</a></li> <li><a href="#steal" id="markdown-toc-steal">Steal</a></li> <li><a href="#subcombatdamage" id="markdown-toc-subcombatdamage">SubCombatDamage</a></li> <li><a href="#targetobject" id="markdown-toc-targetobject">TargetObject</a></li> <li><a href="#tohit" id="markdown-toc-tohit">ToHit</a></li> <li><a href="#useanimobj" id="markdown-toc-useanimobj">UseAnimObj</a></li> <li><a href="#useobj" id="markdown-toc-useobj">UseObj</a></li> <li><a href="#useobjon" id="markdown-toc-useobjon">UseObjOn</a></li> <li><a href="#useskill" id="markdown-toc-useskill">UseSkill</a></li> <li><a href="#useskillon" id="markdown-toc-useskillon">UseSkillOn</a></li> <li><a href="#withinperception" id="markdown-toc-withinperception">WithinPerception</a></li> <li><a href="#устаревшие-крючки" id="markdown-toc-устаревшие-крючки">Устаревшие крючки</a></li> </ul><hr /> <h2 id="adjustfid"> <a href="#adjustfid" class="anchor-heading" aria-labelledby="adjustfid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustFID </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ADJUSTFID</code> (hs_adjustfid.int)</p> <p>Runs after calculating character figure FID on the inventory screen, whenever the game decides that character appearance might change. Also happens on other screens, like barter.</p> <p><strong>NOTE:</strong> FID has following format: <code class="language-plaintext highlighter-rouge">0x0ABBCDDD</code>, where: <code class="language-plaintext highlighter-rouge">A</code> - object type, <code class="language-plaintext highlighter-rouge">BB</code> - animation code (always 0 in this case), <code class="language-plaintext highlighter-rouge">C</code> - weapon code, <code class="language-plaintext highlighter-rouge">DDD</code> - FRM index in LST file.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the vanilla FID calculated by the engine according to critter base FID and armor/weapon being used
int     arg1 - the modified FID calculated by the internal sfall code (like Hero Appearance Mod)

int     ret0 - overrides the calculated FID with provided value
</code></pre></div></div> <h2 id="adjustpoison"> <a href="#adjustpoison" class="anchor-heading" aria-labelledby="adjustpoison"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustPoison </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ADJUSTPOISON</code> (hs_adjustpoison.int)</p> <p>Runs when a critter’s poison level is changed, or when the player takes damage from the poison.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter
int     arg1 - the amount of poison being added/removed
int     arg2 - the damage value at the time of applying the poison effect
               (damage from the poison effect is implemented only for the player character; for other critters, this value will always be 0)

int     ret0 - the new amount of poison being added/removed
int     ret1 - the new damage value, only negative values are allowed (will only be valid at the time of taking damage from the poison)
</code></pre></div></div> <h2 id="adjustrads"> <a href="#adjustrads" class="anchor-heading" aria-labelledby="adjustrads"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AdjustRads </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ADJUSTRADS</code> (hs_adjustrads.int)</p> <p>Runs when a critter’s radiation level is changed.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter (usually dude_obj)
int     arg1 - the amount of radiation being added/removed

int     ret0 - the new amount of radiation being added/removed
</code></pre></div></div> <h2 id="afterhitroll"> <a href="#afterhitroll" class="anchor-heading" aria-labelledby="afterhitroll"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AfterHitRoll </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_AFTERHITROLL</code> (hs_afterhitroll.int)</p> <p>Запускается после того, как Fallout определил, является ли атака попаданием или промахом.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Тип попадания: 0 - critical miss, 1 - miss, 2 - hit, 3 - critical hit
Critter arg1 - Атакующий криттер
Critter arg2 - Атакуемая цель
int     arg3 - Атакуемая часть тела цели
int     arg4 - Шанс попадания

int     ret0 - Переопределяет тип атаки попадание/промах
int     ret1 - Переопределяет атакуемую часть тела цели
Critter ret2 - Переопределяет цель атаки
</code></pre></div></div> <h2 id="ammocost"> <a href="#ammocost" class="anchor-heading" aria-labelledby="ammocost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AmmoCost </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_AMMOCOST</code> (hs_ammocost.int)</p> <p>Выполняется при расчете стоимости (cost) боеприпасов для оружия. Не влияет на урон, только на то, сколько боеприпасов будет израсходовано. По умолчанию оружие выстрелит, когда останется хотя бы 1 патрон, независимо от расчетов стоимости боеприпасов. Чтобы добавить правильную проверку боеприпасов перед стрельбой и правильный расчет количества патронов в очереди (тип крюка: 1 и 2 аргумента arg3), установите опцию <strong>CheckWeaponAmmoCost</strong> в разделе <strong>Misc</strong> в файле ddraw.ini.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Item    arg0 - Указатель на оружие
int     arg1 - Количество пуль в очереди или 1 для одиночных выстрелов
int     arg2 - Количество боеприпасов которые будет израсходованы, рассчитанное с помощью исходной формулы стоимости боеприпасов (в основном это 2, для "Super Cattle Prod" и "Mega Power Fist")
               ПРИМЕЧАНИЕ: для 2-го типа крюка, это значение равно стоимости патронов за раунд (по умолчанию всегда равно 1)
               The amount of ammo that will be consumed, calculated by the original ammo cost function (this is basically 2 for Super Cattle Prod and Mega Power Fist)
               NOTE: for hook type 2, this value is the ammo cost per round (default is always 1)
int     arg3 - Тип крючка:
               0 - при вычитании боеприпасов после атаки одиночным выстрелом
               1 - при проверке "Out of Ammo" перед атакой
               2 - при расчете количества пуль (rounds) в очереди
               3 - при вычитании боеприпасов после атаки очередью

int     ret0 - Новое количество боеприпасов которое будет израсходовано или стоимость боеприпасов за раунд для 2-го типа крюка. Значение 0 для неограниченного количества боеприпасов
</code></pre></div></div> <h2 id="barterprice"> <a href="#barterprice" class="anchor-heading" aria-labelledby="barterprice"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> BarterPrice </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_BARTERPRICE</code> (hs_barterprice.int)</p> <p>Выполняется всякий раз, когда рассчитывается стоимость приобретаемых товаров.</p> <p>ПРИМЕЧАНИЕ: Крючек выполняется дважды, при входе в бартер и после транзакции: первый раз для игрока, а второй раз для NPC.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - NPC совершающее обмен (либо `dude_obj`, либо `inven_dude`)
Critter arg1 - NPC с которым обмениваются
int     arg2 - Стоимость товаров по умолчанию
Critter arg3 - Стек с запрашиваемыми предметами (покупаемых у NPC)
int     arg4 - Количество фактических денег в бартерном стеке (в отличие от товаров)
int     arg5 - Стоимость всех продаваемых товаров, до модификации навыками
Critter arg6 - Стек предлагаемых предметами (продаваемых для NPC)
int     arg7 - Общая стоимость товаров, предлагаемых игроком
int     arg8 - 1 - если была нажата кнопка "Предложения" (не для членом партии игрока), 0 в противном случае
int     arg9 - 1 - если бартер происходит с членом партии игрока, 0 в противном случае

int     ret0 - Измененная стоимость всех приобретаемых товаров (передайте значение -1, если вы просто хотите изменить предлагаемые товары)
int     ret1 - Измененная стоимость всех предлагаемых товаров
</code></pre></div></div> <h2 id="bestweapon"> <a href="#bestweapon" class="anchor-heading" aria-labelledby="bestweapon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> BestWeapon </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_BESTWEAPON</code> (hs_bestweapon.int)</p> <p>Runs when the AI decides which weapon is the best while searching the inventory for a weapon to equip in combat. This also runs when the player presses the “Use Best Weapon” button on the party member control panel.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter searching for a weapon
Item    arg1 - the best weapon chosen from two items
Item    arg2 - the first choice of weapon
Item    arg3 - the second choice of weapon
Critter arg4 - the target of the critter (can be 0)

Item    ret0 - overrides the chosen best weapon
</code></pre></div></div> <h2 id="calcapcost"> <a href="#calcapcost" class="anchor-heading" aria-labelledby="calcapcost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CalcAPCost </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_CALCAPCOST</code> (hs_calcapcost.int)</p> <p>Запускается всякий раз, когда Fallout рассчитывает стоимость AP использование оружия или невооруженной атаки. Не запускается при использовании иных типов предметов или при передвижении. Обратите внимание, что при первой загрузке игры этот скрипт не запускается до отрисовки интерфейса, таким образом, если скрипт влияет на AP стоимость к тому, что находится в руках у игрока в данный момент, будет показана неправильная стоимость AP. Это будет исправлено только при следующей перерисовывки панели интерфейса. Вы можете получить объект оружия, проверив слот предмета на основе типа атаки (<code class="language-plaintext highlighter-rouge">ATKTYPE_LWEP1</code>, <code class="language-plaintext highlighter-rouge">ATKTYPE_LWEP2</code>, и т.д.) а затем использовать функци <code class="language-plaintext highlighter-rouge">critter_inven_obj</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Криттер выполняющее действие
int     arg1 - Attack Type (значения ATKTYPE_*)
int     arg2 - 1 - атака является прицельной, иначе 0
int     arg3 - Стоимость AP (поумолчанию для движка) 
Item    arg4 - Оружие для которого рассчитана стоимость. (Если это равно 0, указатель на оружие все еще может быть получен вышеупомянутым методом)

int     ret0 - Новая стоимость AP
</code></pre></div></div> <h2 id="canuseweapon"> <a href="#canuseweapon" class="anchor-heading" aria-labelledby="canuseweapon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CanUseWeapon </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_CANUSEWEAPON</code> (hs_canuseweapon.int)</p> <p>Run when the AI checks whether it can use a weapon. This mostly happens when NPCs try to find weapons in their inventory or on the map.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter doing the check
Item    arg1 - the weapon being checked
int     arg2 - attack type (see ATKTYPE_* constants)
int     arg3 - original result of engine function: 1 - can use, 0 - can't use

int     ret0 - overrides the result of engine function. Any non-zero value allows using the weapon
</code></pre></div></div> <h2 id="cartravel"> <a href="#cartravel" class="anchor-heading" aria-labelledby="cartravel"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CarTravel </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_CARTRAVEL</code> (hs_cartravel.int)</p> <p>Runs continuously during worldmap travel on car.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - vanilla car speed (between 3 and 8 "steps")
int     arg1 - vanilla fuel consumption (100 and below)

int     ret0 - car speed override (pass -1 if you just want to override fuel consumption)
int     ret1 - fuel consumption override
</code></pre></div></div> <h2 id="combatdamage"> <a href="#combatdamage" class="anchor-heading" aria-labelledby="combatdamage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CombatDamage </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_COMBATDAMAGE</code> (hs_subcombatdmg.int)</p> <p>Runs when:</p> <ol> <li>Игра подсчитывает, сколько урона получит каждая цель. Это включает в себя основную цель, а также все дополнительные цели от взрывов и атак очередью. Это происходит до фактической анимации атаки.</li> <li>AI решает, безопасно ли использовать атаку по зоне (атака очередью, гранаты), если атакующий смог бы попасть по дружественной цели.</li> </ol> <p>Не работает для промахов или небоевых повреждений, таких как взрывы динамита.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0  - Атакуемая цель (target)
Critter arg1  - Атакующий криттер
int     arg2  - Количество урона, нанесенного цели
int     arg3  - Количество урона, нанесенного атакующему
int     arg4  - Флаги специальных эффектов повреждений у цели (используйте bwand и DAM_* для проверки определенных флагов)
int     arg5  - Флаги специальных эффектов повреждений у атакующего (используйте bwand и DAM_* для проверки определенных флагов)
int     arg6  - Оружие, использованное при нападении
int     arg7  - Часть тела, которая была атакована
int     arg8  - Damage Multiplier. Обычно это 2 (множитель делится на 2, поэтому значение 3 наносит 1.5-кратный урон, а 8 - 4-кратный урон. Для критических попаданий значение берется из критической таблицы. С перком Silent Death и соответствующими условиями атаки значение будет удвоено)
int     arg9  - Количество пуль, фактически попавших в цель, 1 - для атак ближнего боя (melee)
int     arg10 - Величина отбрасывания (Knockback) цели
int     arg11 - Attack Type (см. значения ATKTYPE_*)
mixed   arg12 - Вычисленные данные атаки (см. C_ATTACK_* для смещений, и используйте функции `get/set_object_data` для получения или установки данных)

int     ret0 - Количество урона, нанесенные для цели
int     ret1 - Количество урона, нанесенные для атакующего
int     ret2 - Флаги специальных эффектов повреждений для цели
int     ret3 - Флаги специальных эффектов повреждений для атакующего
int     ret4 - Величина отбрасывания (Knockback) для цели
</code></pre></div></div> <h2 id="combatturn"> <a href="#combatturn" class="anchor-heading" aria-labelledby="combatturn"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> CombatTurn </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_COMBATURN</code> (hs_combatturn.int)</p> <p>Runs before and after each turn in combat (for both PC and NPC).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type:
               1 - start of turn
               0 - normal end of turn
              -1 - combat ends abruptly (by script or by pressing Enter during PC turn)
              -2 - combat ends normally (hook always runs at the end of combat)
Critter arg1 - critter doing the turn
bool    arg2 - 1 at the start/end of the player's turn after loading a game saved in combat mode, 0 otherwise

int     ret0 - pass 1 at the start of turn to skip the turn, pass -1 at the end of turn to force end of combat
</code></pre></div></div> <h2 id="deathanim1"> <a href="#deathanim1" class="anchor-heading" aria-labelledby="deathanim1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DeathAnim1 </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_DEATHANIM1</code> (hs_deathanim1.int)</p> <p>Запускается до того, как Fallout попытается вычислить анимацию смерти. Позволяет вам изменить оружие которое будет использоваться для анимации смерти. Не работает для криттеров в состоянии нокдауна/нокаута (knockdown/out).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Идентификатор (PID) оружия выполняющего атаку. (Может быть равно -1, если атака безоружна)
Critter arg1 - Атакующий криттер
Critter arg2 - Атакуемая цель
int     arg3 - Количество повреждений (damage) нанесенных цели
int     arg4 - Неиспользуется, всегда -1. Используйте это, если вы используете одну и туже процедуру обработчика для `HOOK_DEATHANIM1` и `HOOK_DEATHANIM2` (начиная с sfall 4.1/3.8.24)

int     ret0 - PID объекта для переопределения атакующего оружия
</code></pre></div></div> <h2 id="deathanim2"> <a href="#deathanim2" class="anchor-heading" aria-labelledby="deathanim2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DeathAnim2 </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_DEATHANIM2</code> (hs_deathanim2.int)</p> <p>Запускается после того, как Fallout рассчитал анимацию смерти. Позволяет вам переопределить идентификатор для анимации смерти, это более лучше, чем <code class="language-plaintext highlighter-rouge">HOOK_DEATHANIM1</code>, но является без выполнения каких либо проверок валидности. При использовании функции <code class="language-plaintext highlighter-rouge">critter_dmg</code> этот скрипт также будет запущен. В этом случае PID оружия будет равен -1, и атакующий криттер укажет на объект со значением <code class="language-plaintext highlighter-rouge">obj_art_fid == 0x20001F5</code>. Не работает для криттеров в состоянии нокдауна/нокаута (knockdown/out).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Item    arg0 - Идентификатор (PID) оружия, выполняющего атаку. (Может быть равно -1, если атака безоружна)
Critter arg1 - Атакующий криттер
Critter arg2 - Атакуемая цель
int     arg3 - Количество повреждений (damage) нанесенных цели
int     arg4 - Идентификатор анимации смерти, вычисленный Fallout

int     ret0 - Переопределенный идентификатор анимации смерти
</code></pre></div></div> <h2 id="descriptionobj"> <a href="#descriptionobj" class="anchor-heading" aria-labelledby="descriptionobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> DescriptionObj </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_DESCRIPTIONOBJ</code> (hs_descriptionobj.int)</p> <p>Runs when using the examine action icon to display the description of an object. You can override the description text. An example usage would be to add an additional description to the item based on player’s stats/skills. Does not run if the script of the object overrides the description.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Obj     arg0 - the object

int     ret0 - a pointer to the new text received by using "get_string_pointer" function
</code></pre></div></div> <h2 id="encounter"> <a href="#encounter" class="anchor-heading" aria-labelledby="encounter"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Encounter </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ENCOUNTER</code> (hs_encounter.int)</p> <p>Runs whenever a random encounter occurs (except the Horrigan meeting and scripted encounters), or when the player enters a local map from the world map. You can override the map for loading or the encounter.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 0 - when a random encounter occurs, 1 - when the player enters from the world map
int     arg1 - the map ID that the encounter will load (see MAPS.h or Maps.txt)
int     arg2 - 1 when the encounter occurs is a special encounter, 0 otherwise

int     ret0 - overrides the map ID, or pass -1 for event type 0 to cancel the encounter and continue traveling
int     ret1 - pass 1 to cancel the encounter and load the specified map from the ret0 (only for event type 0)
</code></pre></div></div> <h2 id="explosivetimer"> <a href="#explosivetimer" class="anchor-heading" aria-labelledby="explosivetimer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ExplosiveTimer </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_EXPLOSIVETIMER</code> (hs_explosivetimer.int)</p> <p>Runs after setting the explosive timer. You can override the result.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the time in ticks set in the timer
Obj     arg1 - the explosive object
int     arg2 - the result of engine calculation of whether the timer was set successfully: 1 - failure, 2 - success (similar to ROLL_* in Condtion.h)

int     ret0 - overrides the time of the timer (maximum 18000 ticks)
int     ret1 - overrides the result of engine calculation: 0/1 - failure, 2/3 - success (similar to ROLL_*), any other value - use engine handler
</code></pre></div></div> <h2 id="findtarget"> <a href="#findtarget" class="anchor-heading" aria-labelledby="findtarget"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FindTarget </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_FINDTARGET</code> (hs_findtarget.int)</p> <p>Запускается, когда AI пытается выбрать цель в бою. Fallout сначала выбирает список из 4 возможных целей, затем сортирует их в порядке слабости/расстояния/и т.д. в зависимости от параметров AI атакующего. Этот hook заменяет функцию сортировки, позволяя вам сортировать цели каким-либо произвольным способом.</p> <p>Возвращаемые значения могут включать криттеров, которых не было в списке возможных целей, но дополнительные цели все равно могут быть отброшены позже в ходе боя, если они находятся вне поля зрения атакующих или вероятность успешного попадания по ним слишком мала. Список возможных целей часто включает повторяющиеся записи, но это исправлено в sfall 4.2.3/3.8.23. Используйте <code class="language-plaintext highlighter-rouge">set_sfall_return</code>, чтобы указать 4 цели в порядке предпочтения. Если вы хотите указать менее 4-х целей, установите дополнительные цели в 0 или передайте значение -1, чтобы пропустить возвращаемое значение.</p> <p>__ ПРИМЕЧАНИЕ:__ Fallout может выбирать цели по следующим критериям: 1) Ближайший враг к атакующему. 2) Враг напавший на атакующего. 3) Враг напавший на NPC из той же команды, что и атакующий. 4) Враг на которого нападает NPC из той же команды, что и атакующий.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Атакующий криттер
Critter arg1 - Возможная цель
Critter arg2 - Возможная цель
Critter arg3 - Возможная цель
Critter arg4 - Возможная цель

Critter ret0 - Первая выбранная цель
Critter ret1 - Вторая выбранная цель
Critter ret2 - Третья выбранная цель
Critter ret3 - Четвертая выбранная цель
</code></pre></div></div> <h2 id="gamemodechange"> <a href="#gamemodechange" class="anchor-heading" aria-labelledby="gamemodechange"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GameModeChange </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_GAMEMODECHANGE</code> (hs_gamemodechange.int)</p> <p>Runs once every time when the game mode was changed, like opening/closing the inventory, character screen, pipboy, etc.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 1 - when the player exits the game, 0 - otherwise
int     arg1 - the previous game mode
</code></pre></div></div> <h2 id="invenwield"> <a href="#invenwield" class="anchor-heading" aria-labelledby="invenwield"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> InvenWield </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_INVENWIELD</code> (hs_invenwield.int)</p> <p>Runs before causing a critter or the player to wield/unwield an armor or a weapon (except when using the inventory by PC). An example usage would be to change critter art depending on armor being used or to dynamically customize weapon animations.</p> <p><strong>NOTE:</strong> When replacing a previously wielded armor or weapon, the unwielding hook will not be executed. If you need to rely on this, try checking if armor/weapon is already equipped when wielding hook is executed.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - critter
Item    arg1 - item being wielded or unwielded (weapon/armor)
int     arg2 - slot (INVEN_TYPE_*)
int     arg3 - 1 when wielding, 0 when unwielding
int     arg4 - 1 when removing an equipped item from inventory, 0 otherwise

int     ret0 - overrides hard-coded handler (-1 - use engine handler, any other value - override) - NOT RECOMMENDED
</code></pre></div></div> <h2 id="inventorymove"> <a href="#inventorymove" class="anchor-heading" aria-labelledby="inventorymove"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> InventoryMove </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_INVENTORYMOVE</code> (hs_inventorymove.int)</p> <p>Runs before moving items between inventory slots in dude interface. You can override the action. What you can NOT do with this hook:</p> <ul> <li>force moving items to inappropriate slots (like gun in armor slot) What you can do:</li> <li>restrict player from using specific weapons or armors</li> <li>add AP costs for all inventory movement including reloading</li> <li>apply or remove some special scripted effects depending on PC’s armor</li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Target slot:
               0 - main backpack
               1 - left hand
               2 - right hand
               3 - armor slot
               4 - weapon, when reloading it by dropping ammo
               5 - container, like bag/backpack
               6 - dropping on the ground
               7 - picking up item
               8 - dropping item on the character portrait
Item    arg1 - Item being moved
Item    arg2 - Item being replaced, weapon being reloaded, or container being filled (can be 0)

int     ret0 - Override setting (-1 - use engine handler, any other value - prevent relocation of item/reloading weapon/picking up item)
</code></pre></div></div> <h2 id="itemdamage"> <a href="#itemdamage" class="anchor-heading" aria-labelledby="itemdamage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ItemDamage </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ITEMDAMAGE</code> (hs_itemdamage.int)</p> <p>Запускается при получении оценки урона (damage) при использовании оружия, которое может быть и кулаками (fist).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Минимальный урон по умолчанию
int     arg1 - Максимальный урон по умолчанию
Item    arg2 - Используемое оружие, 0 - если безоружен
Critter arg3 - Криттер совершающий атаку
int     arg4 - Тип атаки
int     arg5 - Ненулевое значение, если это атака с использованием оружия ближнего (melee) боя 

int     ret0 - Новый урон для оружия (если возвращаемое значение для ret1 не задано), иначе это задает новый минимальный урон
int     ret1 - Новый максимальный урон для оружия
</code></pre></div></div> <h2 id="keypress"> <a href="#keypress" class="anchor-heading" aria-labelledby="keypress"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> KeyPress </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_KEYPRESS</code> (hs_keypress.int)</p> <p>Запускается каждый раз, когда была нажата (pressed) или отпущена (released) какая-либо клавиша.</p> <ul> <li>DX сканкоды: смотри файл заголовка <strong>dik.h</strong> или https://kippykip.com/b3ddocs/commands/scancodes.htm</li> <li><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd375731%28v=vs.85%29.aspx">VK сканкоды</a></li> </ul> <p><strong>ПРИМЕЧАНИЕ:</strong> Если вы хотите переопределить клавишу, новый DX-сканкод клавиши должен быть одинаковым как для нажатых, так и для отпущенных событий.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Тип события: 1 - pressed, 0 - released
int     arg1 - DX-сканкод клавиши
int     arg2 - VX-сканкод клавиши (это очень похоже на коды ASCII)

int     ret0 - Переопределяет нажатую клавишу: новый DX-сканкод клавиши. Значение 0 если переопределение не требуется
</code></pre></div></div> <h2 id="mouseclick"> <a href="#mouseclick" class="anchor-heading" aria-labelledby="mouseclick"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MouseClick </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_MOUSECLICK</code> (hs_mouseclick.int)</p> <p>Запускается каждый раз, когда была нажата (pressed) или отпущена (released) кнопка мыши.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Тип события: 1 - pressed, 0 - released
int     arg1 - Номер кнопки (0 - левая, 1 - правая, и т.д. до 7)
</code></pre></div></div> <h2 id="movecost"> <a href="#movecost" class="anchor-heading" aria-labelledby="movecost"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MoveCost </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_MOVECOST</code> (hs_movecost.int)</p> <p>Выполняется при расчете стоимости AP для передвижения.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Криттер осуществляющий движение
int     arg1 - Количество гексов для передвижения 
int     arg2 - Стоимость AP

int     ret0 - Новая стоимость AP
</code></pre></div></div> <h2 id="ondeath"> <a href="#ondeath" class="anchor-heading" aria-labelledby="ondeath"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> OnDeath </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ONDEATH</code> (hs_ondeath.int)</p> <p>Запускается сразу после того, как криттер умирает по любой причине. Не возвращает никаких значений, это просто для удобство, когда вам необходимо что-то сделать после смерти для большого количества разных криттеров, и вы не хотите писать скрипты для каждого из них.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Криттер, который только что умер
</code></pre></div></div> <h2 id="onexplosion"> <a href="#onexplosion" class="anchor-heading" aria-labelledby="onexplosion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> OnExplosion </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ONEXPLOSION</code> (hs_onexplosion.int)</p> <p>Runs when Fallout is checking all the tiles within the explosion radius for targets before an explosion occurs. The tile checking will be interrupted when 6 additional targets (critters) are received.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 1 - when checking objects within the explosion radius without causing damage (e.g. the player drops an active explosive), 0 - otherwise
Critter arg1 - the attacker
int     arg2 - the tile on which the explosion occurs
int     arg3 - checked tile within the explosion radius
Obj     arg4 - first found object on the checked tile as an additional target
Critter arg5 - the target critter, may be 0 or equal to the attacker
int     arg6 - 1 when using throwing weapons (e.g. grenades), 0 otherwise

int     ret0 - overrides the found object on the checked tile, pass 0 to skip the object
</code></pre></div></div> <h2 id="removeinvenobj"> <a href="#removeinvenobj" class="anchor-heading" aria-labelledby="removeinvenobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RemoveInvenObj </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_REMOVEINVENOBJ</code> (hs_removeinvenobj.int)</p> <p>Запускается, когда предмет по какой-либо причине удаляется из контейнера или инвентаря криттера.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Obj     arg0 - Объект владелец, из которого удаляется предмет
Item    arg1 - Предмет, который удаляется
int     arg2 - Количество предметов для удаления
int     arg3 - Причина удаления объекта (см. значения RMOBJ_*)
Obj     arg4 - Объект в который (destination) перемещается предмет, в противном случае 0
</code></pre></div></div> <h2 id="resttimer"> <a href="#resttimer" class="anchor-heading" aria-labelledby="resttimer"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RestTimer </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_RESTTIMER</code> (hs_resttimer.int)</p> <p>Runs continuously while the player is resting (using pipboy alarm clock).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the game time in ticks
int     arg1 - event type: 1 - when the resting ends normally, -1 - when pressing ESC to cancel the timer, 0 - otherwise
int     arg2 - the hour part of the length of resting time
int     arg3 - the minute part of the length of resting time

int     ret0 - pass 1 to interrupt the resting, pass 0 to continue the rest if it was interrupted by pressing ESC key
</code></pre></div></div> <h2 id="rollcheck"> <a href="#rollcheck" class="anchor-heading" aria-labelledby="rollcheck"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RollCheck </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_ROLLCHECK</code> (hs_rollcheck.int)</p> <p>Runs when a game event performs a random roll to check the chance of success or failure.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type:
               1 - checks the chance of an attack hitting the target
               2 - checks the chance of a bullet from a burst hitting the target (for burst attacks)
               3 - checks the chance when using skills (not listed below)
               4 - check the chance of using Repair skill
               5 - check the chance of using Doctor skill
               6 - check the chance of using Steal skill for the thief (usually the player)
               7 - the second Steal skill chance check for the target to catch the thief, in which the target's failure is the thief's success result
int     arg1 - the value of roll result (see ROLL_* constants), which is calculated as:
               for ROLL_CRITICAL_SUCCESS: random(1, 100) &lt;= (random_chance / 10) + bonus
               for ROLL_CRITICAL_FAILURE: random(1, 100) &lt;= -random_chance / 10
int     arg2 - the chance value
int     arg3 - the bonus value, used when checking critical success
int     arg4 - random chance (calculated as: chance - random(1, 100)), where a negative value is a failure check (ROLL_FAILURE)

int     ret0 - overrides the roll result
</code></pre></div></div> <h2 id="setglobalvar"> <a href="#setglobalvar" class="anchor-heading" aria-labelledby="setglobalvar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SetGlobalVar </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_SETGLOBALVAR</code> (hs_setglobalvar.int)</p> <p>Runs when setting the value of a global variable.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the index number of the global variable being set
int     arg1 - the set value of the global variable

int     ret0 - overrides the value of the global variable
</code></pre></div></div> <h2 id="setlighting"> <a href="#setlighting" class="anchor-heading" aria-labelledby="setlighting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SetLighting </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_SETLIGHTING</code> (hs_setlighting.int)</p> <p>Runs before setting the light level for an object or a map. You can override the result.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Obj     arg0 - the object being set, or -1 when setting the light level for a map
int     arg1 - the light intensity
int     arg2 - the light radius, or -1 when setting the light level for a map

int     ret0 - overrides the light intensity. Intensity range is from 0 to 65536
int     ret1 - overrides the light radius. Radius range is from 0 to 8 (works only for the object)
</code></pre></div></div> <h2 id="sneak"> <a href="#sneak" class="anchor-heading" aria-labelledby="sneak"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Sneak </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_SNEAK</code> (hs_sneak.int)</p> <p>Runs when the Sneak skill is activated, or when the game rolls another Sneak check after the duration for the current one is over. You can override the result of a random Sneak check or the duration time for the current result.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Sneak check result: 1 - success, 0 - failure
int     arg1 - the duration in ticks for the current Sneak check (time depends on Sneak skill level)
Critter arg2 - the critter (usually dude_obj)

int     ret0 - overrides the result of the Sneak check
int     ret1 - overrides the duration time for the current result
</code></pre></div></div> <h2 id="stdprocedure"> <a href="#stdprocedure" class="anchor-heading" aria-labelledby="stdprocedure"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> StdProcedure </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_STDPROCEDURE</code> (hs_stdprocedure.int)</p> <p>Runs before Fallout executes a standard procedure (handler) in any script of any object. NOTE: this hook will not be executed for <code class="language-plaintext highlighter-rouge">start</code>, <code class="language-plaintext highlighter-rouge">critter_p_proc</code>, <code class="language-plaintext highlighter-rouge">timed_event_p_proc</code>, and <code class="language-plaintext highlighter-rouge">map_update_p_proc</code> procedures.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the number of the standard script handler (see define.h)
Obj     arg1 - the object that owns this handler (self_obj)
Obj     arg2 - the object that called this handler (source_obj, can be 0)

int     ret0 - pass -1 to cancel the execution of the handler
</code></pre></div></div> <h2 id="stdprocedureend"> <a href="#stdprocedureend" class="anchor-heading" aria-labelledby="stdprocedureend"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> StdProcedureEnd </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_STDPROCEDURE_END</code> (hs_stdprocedure.int)</p> <p>Runs after Fallout executes a standard procedure (handler) in any script of any object. NOTE: this hook will not be executed for <code class="language-plaintext highlighter-rouge">start</code>, <code class="language-plaintext highlighter-rouge">critter_p_proc</code>, <code class="language-plaintext highlighter-rouge">timed_event_p_proc</code>, and <code class="language-plaintext highlighter-rouge">map_update_p_proc</code> procedures.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - the number of the standard script handler (see define.h)
Obj     arg1 - the object that owns this handler (self_obj)
Obj     arg2 - the object that called this handler (source_obj, can be 0)
int     arg3 - 1 after procedure execution
</code></pre></div></div> <h2 id="steal"> <a href="#steal" class="anchor-heading" aria-labelledby="steal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Steal </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_STEAL</code> (hs_steal.int)</p> <p>Runs when checking an attempt to steal or plant an item in other inventory using Steal skill.</p> <p>This is fired before the default handlers are called, which you can override. In this case you MUST provide message of the result to player (“You steal the %s”, “You are caught planting the %s”, etc.). Example message (vanilla behavior):<br /> <code class="language-plaintext highlighter-rouge">display_msg(sprintf(mstr_skill(570 + (isSuccess != false) + arg3 * 2), obj_name(arg2)));</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Thief
Obj     arg1 - The target
Item    arg2 - Item being stolen/planted
int     arg3 - 0 when stealing, 1 when planting

int     ret0 - overrides hard-coded handler (1 - force success, 0 - force fail, -1 - use engine handler)
</code></pre></div></div> <h2 id="subcombatdamage"> <a href="#subcombatdamage" class="anchor-heading" aria-labelledby="subcombatdamage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> SubCombatDamage </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_SUBCOMBATDAMAGE</code> (hs_subcombatdamage.int)</p> <p>This hook overrides the vanilla damage calculation formula. Runs when:</p> <ol> <li>Before the game calculates how much damage each target will get. This includes primary target as well as all extras (explosions and bursts).</li> <li>AI decides whether it is safe to use area attack (burst, grenades), if he might hit friendlies.</li> </ol> <p>Does not run for misses, non-combat damage like dynamite explosions, or if one of the damage formulas is selected in ddraw.ini.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the attacker
Critter arg1 - the target
Item    arg2 - the weapon used in the attack
int     arg3 - attack type (see ATKTYPE_* constants)
int     arg4 - number of bullets actually hit the target (1 for melee attacks)
int     arg5 - target's Damage Resistance (DR) value (affected by critical hit effects, perks, traits, and special unarmed attacks)
int     arg6 - target's Damage Threshold (DT) value (affected by critical hit effects, perks, traits, and special unarmed attacks)
int     arg7 - bonus ranged damage from the perk
int     arg8 - damage multiplier (this is divided by 2, so a value of 3 does 1.5x damage, and 8 does 4x damage. Usually it's 2; for critical hits, the value is taken from the critical table; with Silent Death perk and the corresponding attack conditions, the value will be doubled)
int     arg9 - combat difficulty multiplier (125 - rough, 100 - normal, 75 - wimpy; for player or party members it's always 100)
int     arg10 - the calculated amount of damage (usually 0, required when using multiple hook scripts to calculate damage and using the set_sfall_arg function)
mixed   arg11 - computed attack data (see C_ATTACK_* for offsets and use get/set_object_data functions to get/set the data)

int     ret0 - the returned amount of damage
</code></pre></div></div> <h2 id="targetobject"> <a href="#targetobject" class="anchor-heading" aria-labelledby="targetobject"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> TargetObject </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_TARGETOBJECT</code> (hs_targetobject.int)</p> <p>Runs when the targeting cursor hovers over an object, or when the player tries to attack the target object. You can override the target object or prevent the player from attacking the chosen target.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - event type: 0 - when the targeting cursor hovers over the object, 1 - when trying to attack the target object
int     arg1 - 1 when the target object is valid to attack, 0 otherwise
Obj     arg2 - the target object

mixed   ret0 - overrides the target object, or pass -1 to prevent the player from attacking the object
</code></pre></div></div> <h2 id="tohit"> <a href="#tohit" class="anchor-heading" aria-labelledby="tohit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> ToHit </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_TOHIT</code> (hs_tohit.int)</p> <p>Запускается, когда Fallout рассчитывает шанс атаки поразить цель. Выполняется после того, как вероятность попадания полностью рассчитана в нормальном режиме, это включает в себя и применение ограничения в 95%.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int     arg0 - Шанс попадания (capped)
Critter arg1 - Атакующий криттер
Critter arg2 - Атакуемая цель
int     arg3 - Атакуемая часть тела цели
int     arg4 - Исходная плитка (tile). Mожет отличаться от гекса атакующего, когда AI рассматривает потенциальную огневую позицию
int     arg5 - Attack Type: значения ATKTYPE_*
int     arg6 - Ranged flag: 1 - означает, что вероятность попадания рассчитывается с учетом бонусов/штрафов за расстояние до цели
int     arg7 - Значение шанса попадания без применения верхнего или нижнего ограничении (w/o capped) 

int     ret0 - Новое значение шанса попадания
</code></pre></div></div> <h2 id="useanimobj"> <a href="#useanimobj" class="anchor-heading" aria-labelledby="useanimobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseAnimObj </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_USEANIMOBJ</code> (hs_useanimobj.int)</p> <p>Runs before playing the “use” (usually “magic hands”) animation when a critter uses a scenery/container object on the map, or before walking/running animation if the player is at a distance from the object.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the critter that uses an object (usually dude_obj)
Obj     arg1 - the object being used
int     arg2 - the animation code being used (see ANIM_* in Animcomd.h)

int     ret0 - overrides the animation code (pass -1 if you want to skip the animation)
</code></pre></div></div> <h2 id="useobj"> <a href="#useobj" class="anchor-heading" aria-labelledby="useobj"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseObj </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_USEOBJ</code> (hs_useobj.int)</p> <p>Запускается, когда:</p> <ol> <li>Криттер использует предмет из инвентаря, для которого установлен флаг действия <code class="language-plaintext highlighter-rouge">Use</code>, или это активная вспышка (Flare) или Динамит.</li> <li>Игрок использует предмет из основного интерфейса.</li> </ol> <p>Это срабатывает перед использованием предмета, и выполнения процедуры скрипта <code class="language-plaintext highlighter-rouge">use_obj</code>. Вы можете отключить поведение предмета по умолчанию.</p> <p><strong>ПРИМЕЧАНИЕ:</strong> Вы не можете удалить или уничтожить используемый предмет во время выполнения hook скрипта, в противном случае игра выйдет из строя. Чтобы правильно удалить предмет, возвратите значение 1.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Криттер который использует предмет
Obj     arg1 - Используемый предмет

int     ret0 - Переопределяет движковой обработчик и определяет, что должно произойти с предметом: 0 - положить обратно, 1 - удалить, -1 - использовать обработчик движка
</code></pre></div></div> <h2 id="useobjon"> <a href="#useobjon" class="anchor-heading" aria-labelledby="useobjon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseObjOn </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_USEOBJON</code> (hs_useobjon.int)</p> <p>Запускается, когда:</p> <ol> <li>Криттер использует предмет на другом криттере. (или сам на себя)</li> <li>Криттер использует предмет в инвентаре, и у этого объекта не установлен флаг действия <code class="language-plaintext highlighter-rouge">Use</code>, не является предметом активная вспышка (Flare) или Взрывчаткой.</li> <li>Игрок или AI употребляет какой-либо предмет наркотика (drugs)</li> </ol> <p>Это срабатывает перед использованием предмета, и выполнения процедуры скрипта <code class="language-plaintext highlighter-rouge">use_obj_on</code>. Вы можете отключить поведение предмета по умолчанию.</p> <p><strong>ПРИМЕЧАНИЕ:</strong> Вы не можете удалить или уничтожить используемый предмет во время выполнения hook скрипта, в противном случае игра выйдет из строя. Чтобы правильно удалить предмет, возвратите значение 1.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Цель на которую применяется предмет
Critter arg1 - Криттер который использует предмет
int     arg2 - Используемый предмет

int     ret0 - Переопределяет движковой обработчик и определяет, что должно произойти с предметом: 0 - положить обратно, 1 - удалить, -1 - использовать обработчик движка
</code></pre></div></div> <h2 id="useskill"> <a href="#useskill" class="anchor-heading" aria-labelledby="useskill"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseSkill </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_USESKILL</code> (hs_useskill.int)</p> <p>Запускается при использовании навыка на объекте.</p> <p>Это срабатывает до вызова обработчиков по умолчанию, которые вы можете переопределить. В этом случае вы должны полностью написать свой собственный обработчик использования навыков, иначе ничего не произойдет (это включает в себя затухание/восстановление экрана, временной интервал и сообщения - все это может быть написано по сценарию, чтобы получать стандартный текстовые сообщения - используйте <code class="language-plaintext highlighter-rouge">message_str_game</code> вместе с <code class="language-plaintext highlighter-rouge">sprintf</code>). Рекомендуемое использование - например переопределите обработчики навыков “First Aid” и “Doctor”, чтобы усилить или ослабить их, переопределите навык Steal (Кража), чтобы в некоторых случаях предотвратить осмотр инвентаря NPC. Внимание: Это не будет запускаться при вскрытии замков.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Криттер который использует навык
Obj     arg1 - Целевой объект
int     arg2 - Номер используемого навыка
int     arg3 - Бонус к навыку от таких предметов, как аптечки первой помощи, сумка доктора 

int     ret0 - Переопределяет движковой обработчик события: -1 - использовать обработчик движка игры,
               любое другое возвращаемое значение - переопределение, при этом нулевое значение будет с вероятностью в 10% удалять используемый медицинский предмет
</code></pre></div></div> <h2 id="useskillon"> <a href="#useskillon" class="anchor-heading" aria-labelledby="useskillon"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> UseSkillOn </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_USESKILLON</code> (hs_useskillon.int)</p> <p>Runs before using any skill on any object. Lets you override the critter that uses the skill.</p> <p><strong>NOTE:</strong> The user critter can’t be overridden when using Steal skill.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - the user critter (usually dude_obj)
Obj     arg1 - the target object/critter
int     arg2 - skill being used

int     ret0 - a new critter to override the user critter. Pass -1 to cancel the skill use, pass 0 to skip this return value
int     ret1 - pass 1 to allow the skill being used in combat (only for dude_obj or critter being controlled by the player)
</code></pre></div></div> <h2 id="withinperception"> <a href="#withinperception" class="anchor-heading" aria-labelledby="withinperception"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> WithinPerception </h2> <p><code class="language-plaintext highlighter-rouge">HOOK_WITHINPRECEPTION</code> (hs_withinperception.int)</p> <p>Runs when checking if one critter sees another critter. This is used in different situations like combat AI. You can override the result.</p> <p><strong>NOTE:</strong> <code class="language-plaintext highlighter-rouge">obj_can_see_obj</code> calls this first when deciding if critter can possibly see another critter with regard to perception, lighting, sneak factors.<br /> If check fails, the end result is false. If check succeeds (e.g. critter is within perception range), another check is made if there is any blocking tile between two critters (which includes stuff like windows, large bushes, barrels, etc.) and if there is - check still fails.<br /> You can override “within perception” check by returning 0 or 1, OR, as a convenience, you can also override blocking check after the perception check by returning 2 instead. In this case you should add “line of sight” check inside your hook script, otherwise critters will detect you through walls.</p> <p>This is fired after the default calculation is made.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Watcher object
Obj     arg1 - Target object
int     arg2 - Result of vanilla function: 1 - within perception range, 0 - otherwise
int     arg3 - Type of hook:
    1 - when being called from obj_can_see_obj script function
    2 - when being called from obj_can_hear_obj script function (need to set ObjCanHearObjFix=1 in ddraw.ini)
    3 - when AI determines whether it sees a potential target when selecting attack targets
    0 - all other cases

int     ret0 - overrides the returned result of the function:
               0 - not in range (can't see)
               1 - in range (will see if not blocked)
               2 - forced detection (will see regardless, only used in obj_can_see_obj scripting function which is called by every critter in the game)
</code></pre></div></div> <h2 id="устаревшие-крючки"> <a href="#устаревшие-крючки" class="anchor-heading" aria-labelledby="устаревшие-крючки"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Устаревшие крючки </h2> <ul> <li><code class="language-plaintext highlighter-rouge">hs_hexmoveblocking.int</code></li> <li><code class="language-plaintext highlighter-rouge">hs_hexaiblocking.int</code></li> <li><code class="language-plaintext highlighter-rouge">hs_hexshootblocking.int</code></li> <li><code class="language-plaintext highlighter-rouge">hs_hexsightblocking.int</code></li> </ul> <p>Запускается при проверке, блокируется ли гекс при построении пути движении, проверки стрельбы, или проверки искусственного интеллекта.</p> <p><strong>ПРИМЕЧАНИЕ:</strong> Эти скрипты-крючки могут стать очень ресурсоемкими, и вам следует избегать их использования. По этой причине эти крючки полностью не поддерживаются в sfall и могут быть удалены в будущих версиях.<br /> Если вы хотите проверить, заблокирован ли какой-либо гекс (tile) или путь, используйте функции: <code class="language-plaintext highlighter-rouge">obj_blocking_tile</code>, <code class="language-plaintext highlighter-rouge">obj_blocking_line</code>, <code class="language-plaintext highlighter-rouge">path_find_to</code>.<br /> Если вы хотите, чтобы скрипт вызывался каждый раз, когда NPC перемещается на гекс в бою, используйте хук <code class="language-plaintext highlighter-rouge">HOOK_MOVECOST</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Critter arg0 - Криттер, от которого происходит проверка, может быть 0
int     arg1 - Номер проверяемого гекса (tile)
int     arg2 - Проверяемый уровень карты
int     arg3 - 1 - если проверяемый гекса блокируется

Obj     ret0 - Указатель на блокируемый объект, если плитка блокируется, иначе 0 если не блокируется 
</code></pre></div></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
